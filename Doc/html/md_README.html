<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Modelling MHC Evolutionary Dynamics: Evolution of MHC repertoire and number of copies:</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Modelling MHC Evolutionary Dynamics
   &#160;<span id="projectnumber">0.9.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md_README.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Evolution of MHC repertoire and number of copies: </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This work is part of the project <a href="https://sites.google.com/site/evobiolab/projects"><b>Evolution of the number of copies of MHC genes: testing the optimality hypothesis and exploring alternatives.</b></a> supported by the Polish Science Centre (NCN).</p>
<p>This branch <b>MhcEvo2000</b> has the ability to be run parellel on multi-core CPUs using openMP with *#pragma omp parallel* preprocessor calls. <b>It aims at simulating the sexual selection component in MHC gene copy number variation</b>.</p>
<h2>Documentation: </h2>
<p>Go from here to *./Doc/html/* and launch the *./Doc/html/index.html* file in your web browser. The documentation was created with Doxygen.</p>
<h2>Authors: </h2>
<p>Coded by <b>Piotr Bentkowski</b> - <a href="#" onclick="location.href='mai'+'lto:'+'ben'+'tk'+'ows'+'ki'+'.pi'+'ot'+'r@g'+'ma'+'il.'+'co'+'m'; return false;">bentk<span style="display: none;">.nosp@m.</span>owsk<span style="display: none;">.nosp@m.</span>i.pio<span style="display: none;">.nosp@m.</span>tr@g<span style="display: none;">.nosp@m.</span>mail.<span style="display: none;">.nosp@m.</span>com</a> in collaboration with <b>Jacek Radwan</b> - <a href="#" onclick="location.href='mai'+'lto:'+'jra'+'dw'+'an@'+'am'+'u.e'+'du'+'.pl'; return false;">jradw<span style="display: none;">.nosp@m.</span>an@a<span style="display: none;">.nosp@m.</span>mu.ed<span style="display: none;">.nosp@m.</span>u.pl</a></p>
<p>Evolutionary Biology Group Faculty of Biology Adam Mickiewicz University ul. Umultowska 89 61-614 Poznań Poland</p>
<p>www: <a href="https://sites.google.com/site/evobiolab/home">https://sites.google.com/site/evobiolab/home</a> PI : <b>Jacek Radwan</b> - <a href="#" onclick="location.href='mai'+'lto:'+'jra'+'dw'+'an@'+'am'+'u.e'+'du'+'.pl'; return false;">jradw<span style="display: none;">.nosp@m.</span>an@a<span style="display: none;">.nosp@m.</span>mu.ed<span style="display: none;">.nosp@m.</span>u.pl</a></p>
<h2>How to compile: </h2>
<p>The program was written in <a href="https://en.wikipedia.org/wiki/C%2B%2B14">C++14 standard</a> so if you are using GCC, then version gcc 4.8 seems to be the minimum requirement (I had 5.4 and 6.2). This program has some serious dependencies on <a href="http://www.boost.org/">C++ Boost Libraries</a>. Should compile smoothly on most modern GNU/Linux distros with Boost Libs installed. Having <a href="http://www.scons.org/">Scons build tool</a> might be useful too. Basic compilation works fine on Ubuntu 16.04 LTS with mentioned packages installed by running the command: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;g++ -O3 -o MHC_model main.cpp Gene.cpp Antigen.cpp Host.cpp Pathogen.cpp H2Pinteraction.cpp Random.cpp Tagging_system.cpp Environment.cpp DataHandler.cpp -fopenmp -std=c++14</div></div><!-- fragment --><p>The code here can be also used as a toolbox for your research. You can stitch your own <em>main_yourown.cpp</em> file with your scenario and tailored procedures (we did so for our research) and compile it using Scons script which is part of this code bundle. To do so run: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;scons -Q scenario=&quot;Scenarios/main_default.cpp&quot;</div></div><!-- fragment --><p> replacing <em>Scenarios/main_default.cpp</em> with the path to your own custom <em>main_xyz.cpp</em>. Use our <em>main_core.cpp</em> file as the base to develop your scenarios of MHC evolution dynamics. WARNING! Using our Scons script overwrites the <em><a class="el" href="main_8cpp.html">main.cpp</a></em> file in the main source directory - always store your scenarios somewhere else than the <em><a class="el" href="main_8cpp.html">main.cpp</a></em> file!</p>
<p>Sometimes your HPC Cluster is lame and old and it has fairly outdated compiler (e.g. gcc &lt; 4.8). Then you can statically link the libraries on your fancy brand new PC running the latest Linux distro and send the no-dependencies executable to cluster. Compile like this: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;g++ -static -O3 -o MHC_model main.cpp Gene.cpp Antigen.cpp Host.cpp Pathogen.cpp H2Pinteraction.cpp Random.cpp Tagging_system.cpp Environment.cpp DataHandler.cpp -fopenmp -std=c++14</div></div><!-- fragment --><p>Or run the Scons script: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;scons -Q scenario=&quot;Scenarios/main_default.cpp&quot; linking=&quot;static&quot;</div></div><!-- fragment --><p> But it may throw some warnings… e.g. */usr/lib/gcc/x86_64-linux-gnu/5/libgomp.a(target.o): In function <code>gomp_target_init</code>: (.text+0xba): warning: Using 'dlopen' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking*.</p>
<h2>How to run: </h2>
<p>The program takes exactly 17 parameters. These are:</p><ul>
<li><b>00</b> - Program's name</li>
<li><b>01</b> - Number of threads program will try to use on a multi-core CPU. Giving 0 will make the program use all CPU cores available.</li>
<li><b>02</b> - Number of bits in a gene.</li>
<li><b>03</b> - Number of bits in an antigen.</li>
<li><b>04</b> - <a class="el" href="class_host.html" title="Core class. Stores and handles a single host object. Each host has multiple instances of Gene class o...">Host</a> population size.</li>
<li><b>05</b> - <a class="el" href="class_pathogen.html" title="Core class. Stores and handles a single pathogen object. Each pathogen can have just one instance of ...">Pathogen</a> population size.</li>
<li><b>06</b> - Number of pathogen species.</li>
<li><b>07</b> - Number of genes in one host chromosome (they have two chromosomes) when the model is being initialised.</li>
<li><b>08</b> - Number of pathogen generations per one host generation.</li>
<li><b>09</b> - Number of host generations (effective length of model run).</li>
<li><b>10</b> - Probability of mutation in hosts ([0,1] range).</li>
<li><b>11</b> - Probability of mutation in pathogens ([0,1] range).</li>
<li><b>12</b> - The heterozygote advantage / lack of advantage mode. It has to be 10 for heterozygote advantage or 11 for lack of thereof.</li>
<li><b>13</b> - Probability of deleting a gene in the host ([0,1] range).</li>
<li><b>14</b> - Probability of duplicating a gene in the host ([0,1] range).</li>
<li><b>15</b> - Maximal number of genes permitted in one host chromosome.</li>
<li><b>16</b> - Number of sexual partners an individual checks out before selecting one for mating.</li>
<li><b>17</b> - Alpha factor for the host fitness function ([0,1] range).</li>
</ul>
<p>Historically we also had one more argument, that can be added if you want:</p><ul>
<li>18 - Fraction of the antigen's bits which are forbidden from changing (a.k.a. <em>No Mutation Bits</em>).</li>
</ul>
<p>This program can recognise simple errors in the argument list (a probability value out of [0,1] range, negative values when only positive are allowed etc.), but will not recognise when they don't make a 'biological' sense.</p>
<h2>The output and data visualisation: </h2>
<p>Program produces a number of text files containing desired data. The file <em>InputParameters.json</em> contains the values of parameters fed to the model. Thefile <em>HostsGeneDivers.csv</em> contains the main statistics of the model, including the time stamp used in the visualisation process of the other files with data. This two files are the basics to analyse the simulation output. Other files are optional and they can be switched off by commenting out some lines in the main function (<em><a class="el" href="main_8cpp.html">main.cpp</a></em> file) what should speed up the program runtime.</p>
<p>All the files are:</p><ul>
<li>***InputParameters.json*** - contains run's parametrisation in JSON text format</li>
<li>***HostsGeneDivers.csv*** - contain basic statistics of the output for host genomes</li>
<li>***HostGenomesFile.[t].csv*** - contains all the genomes of all the cells for host population in time <em>t</em>. There can be more then one file like this for different time snapshots.</li>
<li>***PathoGenomesFile.[t].csv*** - contains all the genomes of all the cells for pathogen population in time <em>t</em>. There can be more then one file like this for different time snapshots.</li>
<li>***HostGeneNumbTotal.csv*** - total number of genes in each individual host in each time step (linked to <em>HostMHCsNumbUniq.csv</em>, that each column in <em>HostGeneNumbTotal.csv</em> is represents the same cells as in <em>HostMHCsNumbUniq.csv</em>).</li>
<li>***HostMHCsNumbUniq.csv*** - number of unique MHC alleles in each individual host in each time step (linked to*HostGeneNumbTotal.csv*, that each column in <em>HostGeneNumbTotal.csv</em> is represents the same cells as in <em>HostMHCsNumbUniq.csv</em>).</li>
<li>***NoMutationInPathoList.csv*** - list of conserved antigen sites. Each line contains one pathogen species, each number indicates the index of a "no-mutation" site in this species antigen. When empty it means there is no mutation restrictions.</li>
<li>***NumberOfMhcAfterMating.csv*** -number of the unique MHC types in each individual host in each time step after the mating procedure took place.</li>
<li>***NumberOfMhcBeforeMating.csv*** - number of the unique MHC types in each individual host in each time step before the mating procedure took place.</li>
<li>***NumberOfMhcInMother.csv*** - number of the unique MHC types in each individual host that is selecting a partner (a.k.a. "mother") in each time step during mating procedure. Each individual has a corresponding partner at the same index in the file <em>NumberOfMhcInFather.csv</em>.</li>
<li>***NumberOfMhcInFather.csv*** - number of the unique MHC types in each individual host that has been selected as a mating (a.k.a. "father") in each time step during mating procedure. Each individual has a corresponding partner at the same index in the file <em>NumberOfMhcInMother.csv</em>.</li>
<li>***PresentedPathogenNumbers.csv*** - number of presented pathogens by each individual in each time step.</li>
</ul>
<p>Visualisation is done using Python 3.6 scripts containing a a lot of calls to Numpy, Matplotlib and other scietific Python libraries. You may wish to consider using the <a href="https://www.anaconda.com/download/">Python Anaconda</a> for your Pythonic endeavours. Visualisation and stats scripts can be found in <em>PyScripts</em> directory.</p>
<p>To load the environment for output analysis run: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;conda env create -f mhcEvoCondaEnv.yaml</div></div><!-- fragment --><p> file <code>mhcEvoCondaEnv.yaml</code> can be found in <em>PyScripts</em> directory. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sat Dec 22 2018 20:45:39 for Modelling MHC Evolutionary Dynamics by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
